import{j as e,Q as S,a as P}from"./@tanstack/react-query-67ad7673.js";import{a as N,r as u}from"./vendor-8a332d8f.js";import{u as f,a as v,P as w}from"./react-redux-f7ec5b86.js";import{o as A}from"./mobx-react-lite-6dfbfb78.js";import{R as _}from"./react-paginate-52341bed.js";import{c as T,a as E,b as L}from"./redux-b3f984f5.js";import{t as M}from"./redux-thunk-ef899f4c.js";import{u as G,f as h,g as D,a as O,b as H}from"./@tanstack/react-table-1a8e61a5.js";import{S as K}from"./react-loading-skeleton-638e8c02.js";import{h as k}from"./moment-a9aaa855.js";import{a as F}from"./axios-9cbf0d09.js";import"./mobx-2e7761d7.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(r){if(r.ep)return;r.ep=!0;const c=n(r);fetch(r.href,c)}})();var p={},m=N;p.createRoot=m.createRoot,p.hydrateRoot=m.hydrateRoot;const I=({handlePageClick:t})=>{const{pageCount:s,currentPage:n}=f(o=>o.baseReducer);return e.jsx(_,{pageCount:s,marginPagesDisplayed:2,pageRangeDisplayed:5,forcePage:n,onPageChange:t,previousLabel:"<",nextLabel:">",containerClassName:"table-pagination",activeClassName:"active"})},y="CHANGE_PAGE_COUNT",x="CHANGE_CURRENT_PAGE",b="CHANGE_SEARCH",$={pageCount:0,currentPage:0,searchTable:""},z=(t=$,s)=>{switch(s.type){case y:return{...t,pageCount:s.payload};case x:return{...t,currentPage:s.payload};case b:return{...t,searchTable:s.payload};default:return t}},j=t=>({type:y,payload:t}),C=t=>({type:x,payload:t}),B=t=>({type:b,payload:t}),R="GET_LIST",U={tableList:[]},q=(t=U,s)=>{switch(s.type){case R:return{...t,tableList:s.payload};default:return t}},Q=t=>({type:R,payload:t}),V=T({baseReducer:z,tableReducer:q}),d=E(V,L(M));class W{dispatch(s){d.dispatch(s)}refreshTableData(){this.dispatch(C(0)),this.dispatch(j(0)),this.dispatch(B(""))}}const J=new W,X=()=>e.jsx("tr",{className:"text-center",children:e.jsx("td",{colSpan:5,children:"Данных нет в таблице...."})}),Y=({col:t})=>e.jsx(e.Fragment,{children:Array(5).fill({}).map((s,n)=>e.jsx("tr",{children:Array(t).fill({}).map((o,r)=>e.jsx("td",{children:e.jsx(K,{height:20})},r))},n))}),Z=({fetchData:t})=>{const[s,n]=u.useState([]),{tableList:o}=f(i=>i.tableReducer);function r(i){return new DOMParser().parseFromString(i,"text/html").documentElement.textContent}const c=[{accessorKey:"received_date",header:"Received",cell:({cell:i,row:a})=>k(a.original.created_at).format("h:m A")},{accessorKey:"pick_up_at",header:"Pick-up At"},{accessorKey:"deliver_to",header:"Delivery"},{accessorKey:"suggested_truck",header:"Vehicle",size:300},{accessorKey:"miles",header:"Miles"},{accessorKey:"match",header:"Match"},{accessorKey:"contact_name",header:"Brokerage",size:100,cell:({cell:i,row:a})=>e.jsxs("span",{children:["(",a.original.source_name.substring(0,1),") ",r(a.original.contact_name)]})}],l=G({columns:c,data:o,getCoreRowModel:D(),getSortedRowModel:O(),getFilteredRowModel:H(),state:{sorting:s},defaultColumn:{minSize:230},onSortingChange:n});return e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table-style",children:[e.jsx("thead",{children:l.getHeaderGroups().map(i=>e.jsx("tr",{children:i.headers.map(a=>e.jsxs("th",{onClick:a.column.getToggleSortingHandler(),children:[h(a.column.columnDef.header,a.getContext()),{asc:e.jsx("i",{className:"ml-2 fa fa-sort-up"}),desc:e.jsx("i",{className:"ml-2 fa fa-sort-down"})}[a.column.getIsSorted()??null]]},a.id))},i.id))}),e.jsxs("tbody",{children:[l.getRowModel().rows.length>0&&t===1&&l.getRowModel().rows.map(i=>e.jsx("tr",{className:"cu-p",id:`row${i.original.id}`,children:i.getVisibleCells().map(a=>e.jsx("td",{children:h(a.column.columnDef.cell,a.getContext())},a.id))},i.id)),t===0&&e.jsx(Y,{col:c.length}),t===2&&e.jsx(X,{})]})]})})},ee=()=>"https://parser-tms.altek.uz",te=(t=1)=>`${ee()}/api/lol/list/?page=${t}`;class se{dispatch(s){d.dispatch(s)}async getList(s){const n=d.getState().baseReducer.currentPage+1,{data:o}=await F.get(te(n));o.results.length>0&&s(1),o.results.length===0&&s(2),this.dispatch(Q(o.results)),this.dispatch(j(Math.ceil(o.count/25)))}}const g=new se,re=()=>{const t=v(),[s,n]=u.useState(0),o=r=>{t(C(r.selected)),g.getList(n)};return u.useEffect(()=>(g.getList(n),()=>{J.refreshTableData()}),[]),e.jsx("div",{className:"page-container",children:e.jsxs("div",{className:"table-wrapper not-btn",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between mb-2",children:e.jsx("h3",{children:"Dispatch"})}),e.jsx(Z,{fetchData:s}),e.jsx(I,{handlePageClick:o})]})})},ae=A(()=>e.jsx(re,{}));const oe=new S({defaultOptions:{queries:{refetchOnWindowFocus:!1}}}),ce=p.createRoot(document.getElementById("root"));ce.render(e.jsx(P,{client:oe,children:e.jsx(w,{store:d,children:e.jsx(ae,{})})}));
